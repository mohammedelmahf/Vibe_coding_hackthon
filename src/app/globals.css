@import "tailwindcss";

/* ─── Design Tokens ─── */
:root {
  --c-bg: #f2f2f7;
  --c-surface: #ffffff;
  --c-text: #1c1c1e;
  --c-text-secondary: #48484a;
  --c-text-muted: #aeaeb2;
  --c-border: rgba(0,0,0,0.06);
  --c-accent: #007aff;
  --c-accent-soft: #e8f0fe;
  --c-success: #30d158;
  --c-error: #ff453a;
  --c-warning: #ff9f0a;
  --c-dark: #1c1c1e;
  --c-fill: rgba(120,120,128,0.12);
  --c-fill-secondary: rgba(120,120,128,0.06);
  --shadow-xs: 0 1px 2px rgba(0,0,0,0.04);
  --shadow-sm: 0 1px 4px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.03);
  --shadow: 0 4px 12px rgba(0,0,0,0.08), 0 1px 3px rgba(0,0,0,0.04);
  --shadow-lg: 0 12px 40px rgba(0,0,0,0.12), 0 4px 12px rgba(0,0,0,0.06);
  /* spring curves */
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
  --ease-out: cubic-bezier(0.25, 1, 0.5, 1);
  --ease-in-out: cubic-bezier(0.45, 0, 0.55, 1);
  /* radius tokens */
  --r-sm: 10px;
  --r-md: 14px;
  --r-lg: 18px;
  --r-xl: 22px;
  --r-full: 9999px;
}

/* ─── Resets ─── */
* {
  -webkit-tap-highlight-color: transparent;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
  overscroll-behavior-y: none;
  -webkit-text-size-adjust: 100%;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Display', system-ui, sans-serif;
  background: var(--c-bg);
  color: var(--c-text);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  letter-spacing: -0.01em;
  overscroll-behavior: none;
  user-select: none;
  -webkit-user-select: none;
}

/* Allow text selection in inputs */
input, textarea, select { user-select: auto; -webkit-user-select: auto; }

/* ─── Skeleton shimmer ─── */
@keyframes shimmer {
  0% { background-position: -300% 0; }
  100% { background-position: 300% 0; }
}

.skeleton {
  background: linear-gradient(90deg, rgba(120,120,128,0.06) 30%, rgba(120,120,128,0.12) 50%, rgba(120,120,128,0.06) 70%);
  background-size: 300% 100%;
  animation: shimmer 1.8s ease-in-out infinite;
  border-radius: var(--r-sm);
}

/* ─── Animations ─── */
@keyframes slide-up {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}

@keyframes fade-in {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes scale-in {
  from { opacity: 0; transform: scale(0.85); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes toast-in {
  from { transform: translateY(-120%); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes count-pop {
  0% { transform: scale(1); }
  50% { transform: scale(1.3); }
  100% { transform: scale(1); }
}

@keyframes gentle-float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-4px); }
}

@keyframes pulse-soft {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

@keyframes slide-in-right {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

@keyframes check-draw {
  0% { stroke-dashoffset: 24; }
  100% { stroke-dashoffset: 0; }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-4px); }
  75% { transform: translateX(4px); }
}

.anim-slide-up { animation: slide-up 0.42s var(--ease-out); }
.anim-fade-in { animation: fade-in 0.35s var(--ease-out) both; }
.anim-scale-in { animation: scale-in 0.3s var(--ease-spring); }
.toast-in { animation: toast-in 0.4s var(--ease-spring); }
.anim-count-pop { animation: count-pop 0.25s var(--ease-spring); }
.anim-shake { animation: shake 0.3s ease; }
.anim-float { animation: gentle-float 3s ease-in-out infinite; }

/* ─── Scrollbar ─── */
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
.no-scrollbar::-webkit-scrollbar { display: none; }

/* ─── Overlay ─── */
.overlay {
  background: rgba(0, 0, 0, 0.35);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

/* ─── Safe areas ─── */
.safe-bottom { padding-bottom: max(env(safe-area-inset-bottom), 16px); }
.safe-top { padding-top: max(env(safe-area-inset-top), 0px); }

/* ─── Buttons ─── */
.btn-primary {
  background: var(--c-accent);
  color: white;
  border: none;
  cursor: pointer;
  transition: transform 0.2s var(--ease-spring), opacity 0.15s, box-shadow 0.2s;
  will-change: transform;
  box-shadow: 0 2px 12px rgba(0,122,255,0.3);
}
.btn-primary:active {
  transform: scale(0.97);
  opacity: 0.88;
}

.btn-dark {
  background: var(--c-dark);
  color: white;
  border: none;
  cursor: pointer;
  transition: transform 0.2s var(--ease-spring), opacity 0.15s, box-shadow 0.2s;
  will-change: transform;
  box-shadow: 0 2px 12px rgba(0,0,0,0.2);
}
.btn-dark:active {
  transform: scale(0.97);
  opacity: 0.88;
}

/* ─── Product card ─── */
.product-card {
  transition: transform 0.25s var(--ease-spring), box-shadow 0.3s ease;
  will-change: transform;
  box-shadow: 0 1px 4px rgba(0,0,0,0.05), 0 0 0 1px rgba(0,0,0,0.03);
}
.product-card:active {
  transform: scale(0.975);
}
@media (hover: hover) {
  .product-card:hover {
    transform: translateY(-3px) scale(1.005);
    box-shadow: 0 12px 28px rgba(0,0,0,0.1), 0 4px 10px rgba(0,0,0,0.04);
  }
  .product-card:hover .card-img {
    transform: scale(1.06);
  }
}
.card-img {
  transition: transform 0.5s var(--ease-out);
}

/* ─── Quantity Stepper ─── */
.qty-stepper {
  display: flex;
  align-items: center;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.12), 0 0 0 1px rgba(0,0,0,0.04);
  background: white;
}
.qty-stepper button {
  width: 34px;
  height: 34px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.15s;
}
.qty-stepper button:active {
  background: var(--c-fill);
}
.qty-stepper .qty-value {
  width: 28px;
  text-align: center;
  font-size: 13px;
  font-weight: 700;
  color: var(--c-text);
  border-left: 1px solid var(--c-border);
  border-right: 1px solid var(--c-border);
  line-height: 34px;
}

/* ─── iOS Segmented Control ─── */
.segmented-control {
  display: flex;
  background: var(--c-fill);
  border-radius: 10px;
  padding: 2px;
  position: relative;
}
.segmented-control button {
  flex: 1;
  padding: 8px 0;
  font-size: 13px;
  font-weight: 600;
  color: var(--c-text-secondary);
  border-radius: 8px;
  transition: color 0.2s;
  z-index: 1;
  position: relative;
}
.segmented-control button[data-active="true"] {
  color: var(--c-text);
}
.segmented-thumb {
  position: absolute;
  top: 2px;
  height: calc(100% - 4px);
  background: var(--c-surface);
  border-radius: 8px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.1), 0 0.5px 1px rgba(0,0,0,0.06);
  transition: left 0.3s var(--ease-out), width 0.3s var(--ease-out);
  z-index: 0;
}

/* ─── iOS-style list cells ─── */
.cell {
  background: var(--c-surface);
  padding: 13px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  transition: background 0.15s;
}
.cell:active { background: var(--c-fill-secondary); }
.cell-group {
  background: var(--c-surface);
  border-radius: var(--r-md);
  overflow: hidden;
  box-shadow: 0 1px 4px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03);
}
.cell-group > .cell + .cell {
  border-top: 0.5px solid var(--c-border);
}

/* ─── Momentum scroll ─── */
.momentum-scroll {
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
  overscroll-behavior-y: contain;
}

/* ─── Select arrow ─── */
.select-arrow {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='%23636366' d='M7 7l3 3 3-3'/%3e%3c/svg%3e");
  background-position: right 12px center;
  background-repeat: no-repeat;
  background-size: 20px;
  padding-right: 40px;
}

/* ─── Form fields ─── */
input:focus, select:focus, textarea:focus {
  outline: none;
}
.input-field {
  width: 100%;
  height: 46px;
  padding: 0 14px;
  border-radius: 12px;
  background: var(--c-fill);
  font-size: 16px; /* prevents iOS zoom */
  color: var(--c-text);
  border: 2px solid transparent;
  transition: border-color 0.2s, background 0.2s, box-shadow 0.2s;
}
.input-field:focus {
  border-color: var(--c-accent);
  background: var(--c-surface);
  box-shadow: 0 0 0 3px rgba(0,122,255,0.12);
}
.input-field.error {
  border-color: var(--c-error);
}
.input-field::placeholder {
  color: var(--c-text-muted);
}

/* ─── Pull indicator ─── */
@keyframes spin {
  to { transform: rotate(360deg); }
}
.loading-spinner {
  width: 20px;
  height: 20px;
  border: 2px solid var(--c-fill);
  border-top-color: var(--c-accent);
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
}

/* ─── Bottom sheet drag indicator ─── */
.sheet-handle {
  width: 36px;
  height: 5px;
  border-radius: 2.5px;
  background: rgba(120,120,128,0.3);
  margin: 6px auto 2px;
}

/* ─── Swipe delete background ─── */
.swipe-delete-bg {
  background: var(--c-error);
  display: flex;
  align-items: center;
  justify-content: flex-end;
  padding-right: 20px;
  color: white;
  font-weight: 600;
  font-size: 14px;
}

/* ─── Badge ─── */
.badge {
  min-width: 18px;
  height: 18px;
  padding: 0 5px;
  border-radius: var(--r-full);
  font-size: 11px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  letter-spacing: 0.01em;
}

/* ─── Utility classes ─── */
.glass {
  background: rgba(255,255,255,0.8);
  backdrop-filter: saturate(180%) blur(20px);
  -webkit-backdrop-filter: saturate(180%) blur(20px);
}
.glass-dark {
  background: rgba(28,28,30,0.88);
  backdrop-filter: saturate(180%) blur(20px);
  -webkit-backdrop-filter: saturate(180%) blur(20px);
}

/* ─── Standalone PWA ─── */
@media all and (display-mode: standalone) {
  body { overscroll-behavior: none; }
  .safe-top { padding-top: env(safe-area-inset-top); }
  .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
}

/* ─── Focus visible ─── */
button:focus-visible, a:focus-visible {
  outline: 2px solid var(--c-accent);
  outline-offset: 2px;
  border-radius: 8px;
}

/* ─── Selection color ─── */
::selection {
  background: rgba(0,122,255,0.2);
  color: var(--c-text);
}
